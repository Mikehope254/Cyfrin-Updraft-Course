# Foundry Fundamentals

Welcome to Foundry 101. Throughout this course, you will acquire the skills you’ll need to start developing your smart contracts and protocols using the best web3 development tools and frameworks like Chainlink, Alchemy, and Foundry.

### What is Foundry?

Foundry is a relatively new but rapidly growing smart contract development framework known for its efficiency and modularity. The best short description of this powerful tool can be found in the [Foundry Book:](https://getfoundry.sh/)

```
Foundry manages your dependencies, compiles your project, runs tests, deploys, and lets you interact with the chain from the command-line and via Solidity scripts.

```

Please take a moment to bookmark the [Foundry Book:](https://getfoundry.sh/). It is the most comprehensive resource that has the answers to all your questions. It will be handy along the way.

Foundry has numerous pros, such as:

- It leverages Rust for compilation, offering significantly faster build times compared to frameworks like Hardhat or Brownie.

- It's entirely Solidity-based, eliminating the need to learn other programming languages

- Its documentation is comprehensive.

### Our favorite code editor: Visual Studio Code

Throughout this course, we will use Visual Studio Code to write, test, deploy and interact with our smart contracts. Visual Studio Code is a lightweight, powerful source code editor available on Windows, macOS and Linux. It has a comprehensive ecosystem of extensions that makes it one of the best choices when it comes to smart contract development.

# Development environment setup (Mac, Linux)
You know this

# Foundry setup

### Keeping your Terminal Clutter-free

When commands pile up in your terminal, things can get a little overwhelming. Clear it up by simply typing `clear` and hitting `Enter`. Alternatively, use `Command K` if you're on a Mac or `Control K` if you're on Linux or Windows.

Pro tip: This is one of my favorite keyboard shortcuts that I use all the time.

### Understanding the Trash Can and the X

The trash can and the X buttons in your terminal perform distinct functions. Hitting X simply hides your terminal but retains all the previous lines of code. On the other hand, trashing it essentially deletes whatever is running in it. To open up a clean terminal, hit the trash can and then pull it back using `Control+`` or `Terminal > New Terminal`.

### Installing Foundry

With our terminal set and some tips up our sleeve, let's progress to installing Foundry. Navigate to the [Foundry website](https://getfoundry.sh/introduction/installation/) and from the installation tab, fetch the command to install Foundry.

The command would look something like this:

```bash
curl -L https://foundry.paradigm.xyz | bash
```

Hit `Enter` after pasting this in your terminal.

Note: You must have Internet access for this to work as it's downloading Foundry from their official website.

### Verifying Your Installation
After running the `curl` command, an output will appear at the bottom of your terminal indicating the detected shell and the fact that Foundry has been added to your Path.

For instance, the output can be something like this:

```bash
Detected your preferred shell is bashrc and added Foundry to Path run:source /home/user/.bashrcStart
a new terminal session to use Foundry
```

Now, simply type `foundryup` and `Enter` to install and update Foundry to the latest version. Whenever you want to install an update for Foundry, simply run `foundryup` again.

This will install four components: forge, cast, anvil, and chisel. To confirm the successful installation, run `forge --version`. You should get an output indicating the Forge version as shown below.

```bash
Forge version x.x.x
```

### Is Foundry Up Not Running?
Don't panic if this command doesn't run. You might have an issue with your path, and you might need to add Foundry to your path. In case you run into this issue, check lesson 6 of the GitHub repo associated with this course. If no debugging tips are available there, feel free to start a discussion on the course's GitHub repo. Before doing so, make sure to check if a similar discussion already exists.

Try typing `forge --version` into your terminal. Have you received an unwelcome output saying `Forge command found?` This implies that you have to rerun the `source` command that Foundry offered during installation.

Note: Most of the time the `bashrc` file gets loaded automatically. However, if this doesn't apply to your setup, the following lines can add the required command to the end of your `Bash profile`. This will ensure that your `bashrc` file loads by default.

```bash
cd ~
echo 'source /home/user/.bashrc' >> ~/.bash_profile
```

> this depends on your operating system, please check foundry docs to see detailed instructions.

# Quiz 7

**1. What is the main purpose of using a version control system like Git in your projects?**
* *a) To automatically fix bugs in the codebase.*
* *b) To optimize the performance of the final application.*
* *c) To design the visual layout of a user interface*
* *d) To track and manage changes to files, especially source code, over time.*

<details>
  <summary>Click to reveal answer</summary>
  <p>d) To track and manage changes to files, especially source code, over time.</p>
</details>

**2. When setting up credentials in some command-line interfaces, typed passwords may not be visually displayed. What is the typical reason for this behavior?**
* *a) It shows that the password has been automatically generated by the system.*
* *b) It indicates that the system does not actually require a password.*
* *c) It's a security measure to prevent ('shoulder surfing') from seeing the password as it's typed.*
* *d) It means the keyboard has temporarily stopped working correctly.*

<details>
  <summary>Click to reveal answer</summary>
  <p>c) It's a security measure to prevent ('shoulder surfing') from seeing the password as it's typed.</p>
</details>

**3. When working within a third-party cloud development platform, what practice is crucial regarding sensitive credentials?**
* *a) Assume the environment is as secure as your local machine for all data.*
* *b) Use only test or non-production credentials with no real-world value.*
* *c) Store credentials directly within the source code for easy access.*
* *d) Share credentials with team members via the platform's chat feature.*

<details>
  <summary>Click to reveal answer</summary>
  <p>b) Use only test or non-production credentials with no real-world value.</p>
</details>

**4. Which of the following represents a key advantage of utilizing a cloud-based development environment?**
* *a) Complete independence from internet connectivity.*
* *b) Guaranteed lower cost compared to local development.*
* *c) Reduced setup time and standardized environment configuration.*
* *d) Enhanced security for handling production secrets.*

<details>
  <summary>Click to reveal answer</summary>
  <p>c) Reduced setup time and standardized environment configuration.</p>
</details>

**5. If a terminal interface is hidden from view but the session itself is not terminated, what typically happens to processes running within that session?**
* *a) The processes continue to run in the background.*
* *b) The processes are automatically paused until the interface is visible again.*
* *c) The processes are transferred to a new, visible terminal session.*
* *d) The processes are immediately stopped.*

<details>
  <summary>Click to reveal answer</summary>
  <p>a) The processes continue to run in the background.</p>
</details>

**6. In the context of blockchain development toolkits, what function does a component often referred to as a 'local node simulator' (like Anvil, Ganache, or Hardhat Network) typically serve?**
* *a) It manages the secure storage of private keys for deploying contracts.*
* *b) It provides an isolated, high-speed local blockchain environment for development, testing, and debugging of smart contracts.*
* *c) It serves as a code editor specifically designed for writing smart contract languages.*
* *d) It acts as a primary interface for sending transactions to the main public blockchain.*

<details>
  <summary>Click to reveal answer</summary>
  <p>b) It provides an isolated, high-speed local blockchain environment for development, testing, and debugging of smart contracts.</p>
</details>

**7. After installing a new command-line utility, what is a common way to verify that the installation was successful and the tool is accessible system-wide?**
* *a) Executing the command name followed by a flag to request its version information (e.g., `toolname --version`).*
* *b) Manually searching the file system for the tool's primary executable file.*
* *c) Checking the system's control panel for a new entry in installed applications.*
* *d) Rebooting the operating system and checking system logs.*

<details>
  <summary>Click to reveal answer</summary>
  <p>a) Executing the command name followed by a flag to request its version information (e.g., `toolname --version`).</p>
</details>

# Create a new Foundry Project
Reminder: We ran the following commands

```bash
mkdir foundry-f23
cd foundry-f23
```

Now type the following commands:

```bash
mkdir foundry-simple-storage-f23
cd foundry-simple-storage-f23
```

You can always make the cd command faster by pressing the Tab key after you type the first couple of letters from the destination name. Tab lets you autocomplete a lot of commands/paths.

If you type `code .` a new instance of VS Code will open, having the foundry-simple-storage-f23 as the default path.

You can see the contents of this folder on the left sidebar. Try the following command:

```bash
touch randomFile.txt
```

This will create a randomFile.txt

If you want to delete it type:

```bash
rm randomFile.txt
```

The terminal is pretty slick when it comes to moving/opening/creating directories/files, changing paths and generally running things. I recommend going through [this tutorial](https://ubuntu.com/tutorials/command-line-for-beginners#1-overview) if you want to learn how to move extra fast.

### Creating a New Project
The way you [create a new Foundry project](https://getfoundry.sh/guides/project-setup/creating-a-new-project/) is by running the `forge init` command. This will create a new Foundry project in your current working directory.

If you want Foundry to create the new project in a new folder type `forge init nameOfNewFolder`.

Keep in mind that by default `forge init` expects an empty folder. If your folder is not empty you must run `forge init --force`.

Be sure to configure your username and email if you encounter errors related to Git configuration.

```bash
git config --global user.email "yourEmail@provider.com"
git config --global user.name "yourUsername"
```

And that's it, your folder should look as follows:

![Foundry1](../foundry1.png)

But what does all this mean?

`lib` is the folder where all your dependencies are installed, here you'll find things like:

- `forge-std` (the forge library used for testing and scripting)

- `openzeppelin-contracts` is the most battle-tested library of smart contracts

- and many more, depending on what you need/install

`scripts` is a folder that houses all your scripts

`src` is the folder where you put all your smart contracts

`test` is the folder that houses all your tests

`foundry.toml` - gives configuration parameters for Foundry

More on these folders and files later.

Please right-click `src`, click on `New File` and name it `SimpleStorage.sol`. Copy the code available [here](https://github.com/Cyfrin/foundry-simple-storage-cu/blob/main/src/SimpleStorage.sol).

One last thing, please delete `Counter.s.sol`, `Counter.sol` and `Counter.t.sol`. These files are a set of basic smart contracts that Foundry provides as a default when you create a new Foundry project.

# Foundry Setup (Windows/WSL)

### WSL setup
Microsoft has significantly improved its development environment support in recent years. However, for _smart contract development_, installing dependencies can sometimes be tricky. To streamline this process, we will use the Windows Subsystem for Linux (WSL): this is a better option because it enables a full-fledged unix-like console on your Windows machine, simplifying the use of tools and utilities commonly found in _unix-based environments_. This setup ensures compatibility with all the code that runs on unix-based systems like macOS and Linux.

To install WSL, you can begin by opening the Windows terminal. On Windows 11, press the Windows key, type "terminal," and hit enter. On Windows 10, you need to install the Windows terminal from the Microsoft Store (select the official app from Microsoft Corporation).

Once installed, open the terminal and type `wsl --install`. This command will initiate the installation process. Afterward, restart your computer. Upon reboot, the terminal will appear again, prompting you to select a Unix username and set a password. WSL will be then successfully installed ✅.

Visual Studio Code
After installing WSL, we need to install a code editor. We will use Visual Studio Code (VS Code), and there are three different methods to install it:

1. Using the Terminal: Utilize `winget`, a package manager pre-installed on Windows 11. Open the terminal and type winget search VS Code to find the desired package. Then, execute `winget install Microsoft.VisualStudioCode` to install VS Code.

2. Via Web Browser: Search for "Visual Studio Code" in your web browser, select the official Microsoft link and download the installer. Follow the prompts, accept the user agreement and customize all the installation options.

3. Using VSCodium: For those who prefer more independence and privacy, there is an open-source alternative called VSCodium. It is similar to VS Code but without Microsoft's telemetry. Download the [VSCodium installer](https://github.com/VSCodium/vscodium/releases) from GitHub and follow its similar installation steps.

Choose the method that best suits your needs. For this course, I will use the official Visual Studio Code from Microsoft.

# VSCode Solidity setup

### Improving Code Format in Visual Studio Code
When you first start, your code might just look like a whole bunch of dull, lifeless, white text.

This can be easily fixed by using one of the `Solidity` extensions. Out of all the Solidity extensions available in the Extensions tab (CTRL/CMD + SHIFT + X) the following are worth mentioning:

1. Solidity by Juan Blanco, the most used Solidity extension out there.

2. Solidity by Nomic Foundation is Patrick's favorite Solidity extension. The rest of the course will be displaying this extension.

3. Solidity Visual Developer is another popular choice.

NOTE: If the code remains unhighlighted despite having installed the extension, there's a quick solution to that. `Press Command + Shift + P` or `Control + Shift + P` on Windows. This opens up the command bar. In the command bar, type in "Settings" and select "Preferences: Open User Settings (JSON)".

If you have nothing in there, create a new setting by typing in:

```solidity
{
  "editor.defaultFormatter": "NomicFoundation.hardhat"
}
```

Use:

`"editor.defaultFormatter": "tintinweb.solidity-visual-auditor"` for Solidity Visual Developer

or

`"editor.defaultFormatter": "JuanBlanco.solidity"` for Solidity by Juan Blanco

### Other interesting extensions
In the previous lesson, we mentioned a file called `foundry.toml`. This also has an extension that formats it to make it easier to read. Please install [Even Better TOML](https://marketplace.visualstudio.com/items?itemName=tamasfe.even-better-toml).

Another indispensable extension is [Inline Bookmarks](https://marketplace.visualstudio.com/items?itemName=tintinweb.vscode-inline-bookmarks).

The Inline Bookmarks plugin facilitates bookmarking the actual code. The extension can be used for document review, auditing, log analysis, and keeping track of development notes and to-do lists. You may share your notes and bookmarks with others with ease because they are saved with your files.

The following default trigger words/tags are configured by default:

```solidity
@todo - (blue) General ToDo remark.
@note - (blue) General remark.
@remind - (blue) General remark.
@follow-up - (blue) General remark.
@audit - (red) General bookmark for potential issues.
@audit-info - (blue) General bookmark for information to be noted for later use.
@audit-ok - (green) Add a note that a specific line is not an issue even though it might look like.
@audit-issue - (purple) Reference a code location an issue was filed for.
```

You can fully customize the colors!

Remember these! They will be very handy in developing and especially in auditing projects.

More details are available [here](https://github.com/tintinweb/vscode-inline-bookmarks).

Next comes the fun part! Let's compile our contract using Foundry!

# Compile a smart contract using Foundry

Open a new terminal. Type in `forge build` or `forge compile` to compile the smart contracts in your project.

Once the compiling is finished, you'll see some new folders in the Explorer tab on the left side. One of them is a folder called out. Here you'll be able to find the [ABI](https://docs.soliditylang.org/en/latest/abi-spec.html) of the smart contract together with the [Bytecode](https://www.geeksforgeeks.org/solidity/introduction-to-bytecode-and-opcode-in-solidity/) and a lot of useful information.

The cache folder also appears. Generally, this folder is used to store temporary system files facilitating the compilation process. But for this course, you can safely ignore it.

### More terminal wizardry
Throughout your solidity development/audit journey you will type a lot of terminal commands, every time to make a change that you want tested you'll probably have to rerun the `forge build` then maybe you test it with `forge test` or run a script with `forge script` and many more. Typing all these over and over again is inefficient and time-consuming. The better way is to use the `up` and `down` arrow keys. The up and down arrow keys to cycle through the recent commands.

Ok, cool! We learned how to compile a contract, but how does one deploy a smart contract?
